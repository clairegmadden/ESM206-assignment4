---
title: "ESM206-assignment4"
author: "Claire Madden, Bridget Gibbons, Andrew Paterson"
date: "11/12/2018"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE, message=FALSE}

library(tidyverse)
library(vcdExtra)
library(RColorBrewer)
library(dplyr)
library(car)
library(effsize)

```

```{r, echo=FALSE, message=FALSE}

lobster_size <- read_csv("lobster_size_abundance.csv")
lobster_traps <- read_csv("lobster_traps.csv")

```


```{r}

lobster_size2 <- as.data.frame(lobster_size)
lobster_size_tidy <- expand.dft(lobster_size2, freq = "COUNT")

#If you guys don't want to change the site name here, no problem!
size_tidy <- lobster_size_tidy %>% 
  mutate(Site=
    case_when(
      SITE == "NAPL" ~ "Naples Reef",
      SITE == "AQUE" ~ "Arroyo Quemado",
      SITE == "MOHK" ~ "Mohawk Reef",
      SITE == "IVEE" ~ "Isla Vista",
      SITE == "CARP" ~ "Carpinteria"
    )
  ) %>% 
  select(-SITE)


```

#Part 2 (Andrew)

```{r}

#Filter for just 2017 results for Part 2, and Exploratory Histogram and QQ Plots

size_2017 <- size_tidy %>% 
  filter(YEAR == "2017") %>%
  select(SIZE, Site)

carapace_hist <- ggplot(size_2017, aes(x = SIZE))+
  geom_histogram(bins = 23, aes(fill = Site))+
  facet_wrap(~Site)

carapace_hist

carapace_qq <- ggplot(size_2017, aes(sample = SIZE))+
  geom_qq()+
  facet_wrap(~Site)

carapace_qq

#The data looks roughly normally distributed, and all sites have a sample size of greater than 30. 

```

```{r}

#Levene's Test for Equal Variances, since we have more than two groups
#H0: Variances are equal
#HA: Variances are not equal

carapace_levene <- leveneTest(SIZE ~ Site, data = size_2017)
carapace_levene

#We reject the null hypothesis of equal variances (p < .001).  Thus, we must use the Kruskal-Wallis test, a non-parametric alternative to one-way ANOVA.

#H0: All ranks are equal, no difference in median carapace size between locations
#HA: At least two ranks differ, at least one difference in group medians between locations

carapace_kwt <- kruskal.test(Site ~ SIZE, data = size_2017)
carapace_kwt  #not sure if this is the right sequence of variables for this test

#We retain the null hypothesis of equal variances (p = .291), and assume no difference in median carapace size between locations.

#Since there is no difference in medians between locations, we do not need to run Cliff's Delta for effect size, and Tukey's post-hoc test doesn't apply for non-ANOVA testing.

```

